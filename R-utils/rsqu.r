#==========================================================================================#
#==========================================================================================#
#      This function computes the R2 for linear model objects.  Currently this has been    #
# tested with lm, glm, and rlm.                                                            #
#------------------------------------------------------------------------------------------#
rsqu <<- function(object){

   #------ Get original dependent variable. -----------------------------------------------#
   ymodel     = object$model[,1]
   ymodel.bar = mean(ymodel)
   #---------------------------------------------------------------------------------------#


   #---------------------------------------------------------------------------------------#
   #      Get the number of data points and degrees of freedom.                            #
   #---------------------------------------------------------------------------------------#
   ny     = length(ymodel)
   np     = length(object$coefficients)
   df.tot = ny - 1
   df.exp = ny - np - 1
   #---------------------------------------------------------------------------------------#


   #----- Get the total sum of squares. ---------------------------------------------------#
   ssq.tot  = sum2(ymodel-ymodel.bar)^2
   var.tot  = ssq.tot / df.tot
   #---------------------------------------------------------------------------------------#


   #----- Get the residual sum of squares. ------------------------------------------------#
   ssq.res  = sum2(object$residuals)^2
   var.res  = ssq.res / df.exp
   #---------------------------------------------------------------------------------------#


   #---------------------------------------------------------------------------------------#
   #      Result contains all statistics used to define R2 and adjusted R2.                #
   #---------------------------------------------------------------------------------------#
   ans = c( n         = ny
          , p         = np
          , df.tot    = df.tot
          , df.exp    = df.exp
          , sd.tot    = sqrt(var.tot)
          , sd.res    = sqrt(var.res)
          , r.squared = 1.0 - ssq.res / ssq.tot
          , adj.r2    = 1.0 - var.res / var.tot
          )#end c
   #---------------------------------------------------------------------------------------#

   return(ans)
}#end rsqu
